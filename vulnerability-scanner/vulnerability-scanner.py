import socket

def port_scan(target):
     print(f"Starting scan on {target}")
     try:
         for port in range(1, 1025):  #Scan ports 1 to 1024
             sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
             sock.settimeout(0.5)
             result = sock.connect_ex((target, port))
             if result == 0:
                 print(f"Port {port}: Open")
             sock.close()
     except KeyboardInterrupt:
         print("Scan interrupted.")
     except socket.gaierror:
         print("Hostname could not be resolved.")
     except socket.error:
         print("Couldn't connect to server.")

import requests

def check_headers(url):
     try:
         response = requests.get(url)
         headers = response.headers

         security_headers = ['X-Frame-Options', 'Strict-Transport-Security', 'X-Content-Type-Options']

         print("Checking for security headers:")
         for header in security_headers:
             if header in headers:
                 print(f"{header}: Present")
             else:
                 print(f"{header}: Missing")
     except requests.exceptions.RequestException as e:
         print(f"Error fetching URL: {e}")

import ssl
import socket
from datetime import datetime

def check_ssl_expiry(hostname):
    print(f"Checking SSL certificate for {hostname}...")
    context = ssl.create_default_context()

    try:
        print("Attempting to create a socket connection...")
        with socket.create_connection((hostname, 443)) as sock:
            print("Socket connection created.")
            print("Attempting to wrap socket with SSL context...")
            with context.wrap_socket(sock, server_hostname=hostname) as ssock:
                print("Socket wrapped with SSL context.")
                cert = ssock.getpeercert()
                print(f"Certificate data received: {cert}")
                
                if cert and 'notAfter' in cert:
                    expiry_date = datetime.strptime(cert['notAfter'], '%b %d %H:%M:%S %Y %Z')
                    print(f"SSL Certificate for {hostname} expires on {expiry_date}")

                    if expiry_date < datetime.now():
                        print("Warning: SSL Certificate has expired!")
                    else:
                        print("SSL Certificate is valid.")
                else:
                    print("No certificate data was found, or 'notAfter' field is missing.")
    except ssl.SSLError as ssl_error:
        print(f"SSL error: {ssl_error}")
    except socket.error as socket_error:
        print(f"Socket error: {socket_error}")
    except Exception as e:
        print(f"An error occurred: {e}")

import argparse

def main():
    parser = argparse.ArgumentParser(description="Basic Vulnerability Scanner")
    parser.add_argument("target", help="IP address or hostname to scan")
    parser.add_argument("--port-scan", action="store_true", help="Perform a port scan")
    parser.add_argument("--header-check", action="store_true", help="Check HTTP security headers")
    parser.add_argument("--ssl-check", action="store_true", help="Check SSL certificate expiration")

    args = parser.parse_args()

    print(f"Scanning target: {args.target}")

    if args.port_scan:
        print("Option selected: Port scan")
        port_scan(args.target)
    
    if args.header_check:
        print("Option selected: HTTP header check")
        check_headers(f"http://{args.target}")
    
    if args.ssl_check:
        print("Option selected: SSL check")
        check_ssl_expiry(args.target)
        
if __name__ == "__main__":
    main()